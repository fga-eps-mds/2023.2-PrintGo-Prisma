generator client {
  provider = "prisma-client-js"
  binaryTargets = ["native", "debian-openssl-3.0.x"]
}

datasource db {
  provider = "cockroachdb"
  url      = env("DATABASE_URL")
}

model User {
  id         String      @id @default(cuid())
  email      String      @unique
  nome       String
  senha      String
  documento  String
  unidade_id String?
  cargos     Cargo[]     @default([USER])
  impressoes Impressao[]
  impressoras Impressora[]
  unidade    Unidade?    @relation(fields: [unidade_id], references: [id])

  @@map("users")
}

model Unidade {
  id          String @id @default(cuid())
  id_unidade_referencia String @unique
  nome        String @unique
  logradouro  String?
  complemento String?
  bairro      String?
  cidade      String?
  cep         String?
  numero      Int?

  usuarios    User[]
  impressoras Impressora[]
  @@map("unidades")
}

model Padrao {
  id                String           @id @default(cuid())
  tipo             String
  marca             String
  modelo             String
  numeroSerie     String
  versaoFirmware  String
  tempoAtivoSistema DateTime
  totalDigitalizacoes Int
  totalCopiasPB Int
  totalCopiasColoridas Int
  totalImpressoesPb Int
  totalImpressoesColoridas Int
  totalGeral Int
  enderecoIp String

  impressoras Impressora[]

  @@map("padroes")
}

model Impressora {
  id                String           @id @default(cuid())
  padrao_id         String
  ip                String @unique
  numeroSerie       String
  codigoLocadora    String
  contadorInstalacao Int
  dataInstalacao DateTime
  dataUltimoContador DateTime
  unidadeId String?
  impressoes        Impressao[]
  locadora User? @relation(fields: [codigoLocadora], references: [id])
  padrao Padrao @relation(fields: [padrao_id], references: [id])
  unidade Unidade? @relation(fields: [unidadeId], references: [id])
  @@map("impressoras")
}

model Impressao {
  id             String     @id @default(cuid())
  impressora_id  String
  user_id        String
  data_impressao DateTime   @default(now())
  nome_documento String
  numero_paginas Int
  impressora     Impressora @relation(fields: [impressora_id], references: [id])
  user           User       @relation(fields: [user_id], references: [id])

  @@map("impressoes")
}

enum EmpressoraStatus {
  ATIVA
  DESATIVA
}

enum Cargo {
  USER
  ADMIN
  LOCADORA
}
